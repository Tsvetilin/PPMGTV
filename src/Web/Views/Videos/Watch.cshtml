@model Web.Models.Videos.VideoViewModel
@using static Common.Helpers.TimeZoneConverter
@using Common.Constants

@{
    ViewData["Title"] = "Watch Video";
}

@if (User.IsInRole(ApplicationRolesNames.EditorRole) || User.IsInRole(ApplicationRolesNames.AdminRole))
{
<div class="d-flex">
    <form class="mx-5" method="get" asp-controller="Videos" asp-action="Edit" asp-route-id="@Model.Id">
        <input class="btn btn-primary" value="Редактирай" type="submit" />
    </form>
    <form class="mx-5" method="post" asp-controller="Videos" asp-action="Delete" asp-route-id="@Model.Id">
        <input type="submit" class="btn btn-danger" value="Изтрий" onclick="return confirm('Сигурен ли си, че искаш да изтриеш това видео?');"/>
    </form>
</div>
}

<div class="m-auto text-center">
    <h1 class="font-weight-bold">
        @Model.Title
    </h1>
</div>

<div class="row">
    <iframe id="video-frame"
            class="m-auto"
            src="@Model.VideoUrl"
            frameborder="0"
            allowfullscreen></iframe>
</div>

<div class="col-md-6 ml-4 py-5">
    <h5>@Model.Description</h5>
    <p>Излъчено на: @Model.PremiredOn.ConvertToLocal()</p>
</div>



@section Scripts {
    <script defer>
        var frame = document.getElementById("video-frame");
        const vhPercent = 0.80;
        if (document.documentElement.clientHeight * vhPercent > document.documentElement.clientWidth) {
            frame.setAttribute("height", `${frame.parentElement.clientWidth * 9 / 16}`);
            frame.setAttribute("width", `${frame.parentElement.clientWidth}`);
        }
        else {
            frame.setAttribute("height", `${document.documentElement.clientHeight * vhPercent}`);
            frame.setAttribute("width", `${document.documentElement.clientHeight * vhPercent * 16 / 9}`);
        }
    </script>
}